<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Baterista SaaS</title>
    <link rel="icon" type="image/png" href="../assets/fiveicon.png">
    <link rel="apple-touch-icon" href="../assets/fiveicon.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Auth Loader Overlay -->
    <div id="auth-loader" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); z-index: 99999; display: flex; justify-content: center; align-items: center; flex-direction: column;">
        <div style="color: var(--primary); font-size: 3rem; margin-bottom: 20px;">
            <i class="fas fa-drum fa-spin"></i>
        </div>
        <h3 style="color: white; font-family: 'Comfortaa', cursive;">Verificando Acesso...</h3>
    </div>

    <div class="dashboard-layout" style="display: none;" id="main-dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="../assets/fiveicon.png" alt="Logo" class="sidebar-logo">
                <span class="logo-text">Musician Portfolio</span>
            </div>
            
            <nav class="nav-menu">
                <a class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a class="nav-item" data-tab="content">
                    <i class="fas fa-pen-nib"></i> Conteúdo
                </a>
                <a class="nav-item" data-tab="media">
                    <i class="fas fa-images"></i> Mídia & Vídeos
                </a>
                <a class="nav-item" data-tab="services">
                    <i class="fas fa-dollar-sign"></i> Preços & Serviços
                </a>
                <a class="nav-item" data-tab="contact">
                    <i class="fas fa-envelope"></i> Contato
                </a>
                <a class="nav-item" data-tab="subscription">
                    <i class="fas fa-credit-card"></i> Assinatura
                </a>
                <a class="nav-item" href="../index.html" target="_blank">
                    <i class="fas fa-external-link-alt"></i> Ver Site
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="nav-item" id="logoutBtn" style="color: var(--danger);">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <header class="topbar">
                <div style="display: flex; align-items: center;">
                    <button id="sidebarToggle" style="background: none; border: none; color: white; font-size: 1.5rem; margin-right: 15px; cursor: pointer; display: none;">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h3 id="page-title">Visão Geral</h3>
                </div>
                <div class="user-profile" id="userProfileDropdown" style="position: relative; cursor: pointer;">
                    <div class="user-info">
                        <span id="userName">Carregando...</span>
                        <small id="userStatus" class="status-active">Assinatura Ativa</small>
                    </div>
                    <img src="../assets/logo.jpg" alt="Profile" class="user-avatar" id="userPhoto">
                    
                    <!-- Dropdown Menu -->
                    <div class="profile-dropdown" id="profileDropdownContent">
                        <div class="dropdown-header">
                            <strong id="dropdownName">Usuário</strong>
                            <span id="dropdownEmail">email@exemplo.com</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" id="switchAccountBtn">
                            <i class="fas fa-exchange-alt"></i> Trocar de Conta
                        </a>
                        <a href="#" class="dropdown-item" id="headerLogoutBtn" style="color: var(--danger);">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                
                <!-- Tab: Dashboard -->
                <div id="tab-dashboard" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h4>Status da Assinatura</h4>
                            <span class="status-badge status-active" id="dashSubStatus">ATIVA</span>
                        </div>
                        <p>Sua assinatura garante o acesso a este painel e a manutenção da sua landing page.</p>
                        <div style="margin-top: 20px; display: flex; gap: 20px;">
                            <div>
                                <small style="color: var(--text-muted);">Próxima Cobrança</small>
                                <h3 id="dashNextBilling">Loading...</h3>
                            </div>
                            <div>
                                <small style="color: var(--text-muted);">Valor</small>
                                <h3>R$ 9,90<small>/mês</small></h3>
                            </div>
                        </div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                             <button id="btnPublishSite" class="btn-primary" style="width: 100%; background: var(--success, #2ecc71);"><i class="fas fa-globe"></i> Publicar Alterações no Site</button>
                             <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 5px; text-align: center;">Clique aqui para garantir que todos vejam sua versão atualizada.</p>
                        </div>
                    </div>
                </div>

                <!-- Tab: Content -->
                <div id="tab-content" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Identidade Visual</h4>
                        </div>
                        <form id="identityForm">
                            <div class="form-group">
                                <label class="form-label">Logo do Site</label>
                                <label class="btn-upload">
                                    <i class="fas fa-cloud-upload-alt"></i> Escolher Logo
                                    <input type="file" id="logoImageFile" accept="image/*" data-target="logoImage" data-preview="logoImagePreview" style="display: none;">
                                </label>
                                <input type="hidden" id="logoImage">
                                <img id="logoImagePreview" src="" alt="Preview" style="max-width: 200px; margin-top: 10px; border-radius: 0; display: none;">
                            </div>
                            <button type="submit" class="btn-primary">Salvar Identidade</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4>Seção Hero (Topo)</h4>
                        </div>
                        <form id="heroForm">
                            <div class="form-group">
                                <label class="form-label">Título Principal</label>
                                <input type="text" class="form-control" id="heroTitle">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Subtítulo</label>
                                <input type="text" class="form-control" id="heroSubtitle">
                            </div>
                            <!-- Image Upload for Hero -->
                            <div class="form-group">
                                <label class="form-label">Imagem Principal (Hero)</label>
                                <label class="btn-upload">
                                    <i class="fas fa-cloud-upload-alt"></i> Escolher Imagem Hero
                                    <input type="file" id="heroImageFile" accept="image/*" data-target="heroImage" data-preview="heroImagePreview" style="display: none;">
                                </label>
                                <input type="hidden" id="heroImage">
                                <img id="heroImagePreview" src="" alt="Preview" style="max-width: 200px; margin-top: 10px; border-radius: 0; display: none;">
                            </div>
                            <button type="submit" class="btn-primary">Salvar Alterações</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4>Agenda / Próximo Show</h4>
                        </div>
                        <form id="eventForm">
                             <div class="form-group" style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                                <input type="checkbox" id="eventActive" style="width: auto;">
                                <label for="eventActive" style="margin: 0; cursor: pointer;">Exibir Seção de Agenda no Site</label>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nome do Evento</label>
                                <input type="text" class="form-control" id="eventTitle" placeholder="Ex: Show de Lançamento">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Data e Local</label>
                                <input type="text" class="form-control" id="eventDate" placeholder="Ex: 15/10/2024 - Blue Note SP">
                            </div>
                             <div class="form-group">
                                <label class="form-label">Link para Mais Informações</label>
                                <input type="text" class="form-control" id="eventLink" placeholder="Ex: https://ticket360.com.br/evento... ou #contact">
                                <small style="color: var(--text-muted);">Use #contact para levar ao formulário de contato do site.</small>
                            </div>
                            <button type="submit" class="btn-primary">Salvar Agenda</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4>Estatísticas (Hero)</h4>
                            <button class="btn-primary" onclick="addStatField()">+ Adicionar</button>
                        </div>
                        <div id="statsList">
                            <!-- Stats Items will be injected here -->
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4>Sobre Mim</h4>
                        </div>
                        <form id="aboutForm">
                            <div class="form-group">
                                <label class="form-label">Subtítulo (Badge)</label>
                                <input type="text" class="form-control" id="aboutSubtitle">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Título</label>
                                <input type="text" class="form-control" id="aboutTitle">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Texto Descritivo</label>
                                <textarea class="form-control" id="aboutText" rows="5"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Imagem (Sobre Mim)</label>
                                <label class="btn-upload">
                                    <i class="fas fa-cloud-upload-alt"></i> Escolher Foto Pessoal
                                    <input type="file" id="aboutImageFile" accept="image/*" data-target="aboutImage" data-preview="aboutImagePreview" style="display: none;">
                                </label>
                                <input type="hidden" id="aboutImage">
                                <img id="aboutImagePreview" src="" alt="Preview" style="max-width: 200px; margin-top: 10px; border-radius: 0; display: none;">
                            </div>
                            <button type="submit" class="btn-primary">Salvar Alterações</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h4>Marcas & Equipamentos</h4>
                            <button class="btn-primary" onclick="addBrandField()">+ Adicionar</button>
                        </div>
                        <div id="brandList">
                            <!-- Brand Items will be injected here -->
                        </div>
                        <button class="btn-primary" style="margin-top: 20px;" onclick="saveBrands()">Salvar Marcas</button>
                    </div>
                </div>

                <!-- Tab: Media -->
                <div id="tab-media" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Vídeo em Destaque (YouTube)</h4>
                        </div>
                        <div id="videoList">
                            <!-- Video Items will be injected here -->
                        </div>
                        <button class="btn-primary" style="margin-top: 20px;" onclick="saveVideos()">Salvar Vídeos</button>
                    </div>

                    <!-- Gallery Images -->
                    <div class="card" style="margin-top: 30px;">
                        <div class="card-header">
                            <h4>Galeria de Fotos</h4>
                        </div>
                        <form id="galleryForm">
                            <div id="gallery-inputs-container" class="responsive-grid">
                                <!-- Generated via admin.js -->
                            </div>
                            <button type="submit" class="btn-primary" style="margin-top: 20px;">Salvar Galeria</button>
                        </form>
                    </div>

                    <!-- Backgrounds -->
                    <div class="card" style="margin-top: 30px;">
                        <div class="card-header">
                            <h4>Backgrounds & Estilo</h4>
                        </div>
                        <form id="styleForm">
                            <div class="form-group">
                                <label class="form-label">Background da Seção de Vídeos</label>
                                <label class="btn-upload">
                                    <i class="fas fa-cloud-upload-alt"></i> Escolher Background
                                    <input type="file" id="videoBgFile" accept="image/*" data-target="videoBg" data-preview="videoBgPreview" style="display: none;">
                                </label>
                                <input type="hidden" id="videoBg">
                                <img id="videoBgPreview" src="" style="max-width: 100%; width: 300px; margin-top: 10px; border-radius: 0; display: none;">
                            </div>
                            <button type="submit" class="btn-primary">Salvar Estilo</button>
                        </form>
                    </div>
                </div>

                <!-- Tab: Services -->
                <div id="tab-services" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Tabela de Preços</h4>
                            <button class="btn-primary" onclick="addPricingField()">+ Adicionar</button>
                        </div>
                        <div id="pricingList">
                            <!-- Pricing Items -->
                        </div>
                        <button class="btn-primary" onclick="savePricing()">Salvar Preços</button>
                    </div>
                </div>

                <!-- Tab: Contact -->
                <div id="tab-contact" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Informações de Contato</h4>
                        </div>
                        <form id="contactForm">
                            <div class="form-group">
                                <label class="form-label">WhatsApp (apenas números)</label>
                                <input type="text" class="form-control" id="contactWhatsapp">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="contactEmail">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Instagram</label>
                                <input type="text" class="form-control" id="contactInstagram">
                            </div>
                            <button type="submit" class="btn-primary">Salvar Contatos</button>
                        </form>
                    </div>
                </div>

                <!-- Tab: Subscription -->
                <div id="tab-subscription" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h4>Detalhes do Plano</h4>
                        </div>
                        <div style="text-align: center; padding: 20px;">
                            <h2 style="color: var(--primary);">Ajuda de Custo Mensal</h2>
                            <h1 style="font-size: 3rem; margin: 10px 0;">R$ 9,90</h1>
                            <p style="color: var(--text-muted);">Para manutenção da plataforma e hospedagem</p>
                            
                            <div id="paymentArea" style="margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 0; border: 1px solid var(--border);">
                                <h4 style="color: var(--text-main); margin-bottom: 15px;">Chave Pix para Pagamento</h4>
                                
                                <div id="pix-qrcode" style="display: flex; justify-content: center; margin-bottom: 20px; background: white; padding: 15px; width: fit-content; margin-left: auto; margin-right: auto; border-radius: 0;"></div>

                                <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 0; margin-bottom: 15px; word-break: break-all; font-family: monospace; color: var(--primary); font-size: 1.1rem; border: 1px dashed var(--primary);">
                                    3bb0e547-a5ec-45a2-a6a0-336a470b4fb2
                                </div>
                                <p style="color: var(--text-muted); font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 10px;">
                                    Realize a transferência e envie o comprovante para o administrador para liberar seu acesso.
                                    <a href="https://wa.me/5582996703421" target="_blank" style="color: #25D366; text-decoration: none; font-weight: bold; display: inline-flex; align-items: center; gap: 5px; font-size: 1.2rem;">
                                        <i class="fab fa-whatsapp"></i>
                                    </a>
                                </p>
                            </div>

                            <!-- Simular Pagamento Removido -->
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Limit Modal -->
    <div id="limitModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 99999; justify-content: center; align-items: center;">
        <div class="modal-content" style="background: var(--surface); padding: 40px; border-radius: 0; max-width: 500px; text-align: center; border: 1px solid var(--border); position: relative;">
            <span class="close-modal" onclick="document.getElementById('limitModal').style.display='none'" style="position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: var(--text-muted);">&times;</span>
            <h3 style="color: var(--primary); margin-bottom: 20px;">Limite Atingido</h3>
            <p style="margin-bottom: 30px; color: var(--text-main);">
                Você atingiu o limite de 3 serviços. Para adicionar mais serviços, é cobrada uma taxa adicional de <strong>R$ 9,90</strong>.
            </p>
            <a href="https://wa.me/5582996703421?text=Olá, gostaria de aumentar o limite de serviços no meu site." target="_blank" class="btn-primary" style="background: #25D366; text-decoration: none; display: inline-block;">
                <i class="fab fa-whatsapp"></i> Falar com Suporte
            </a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script type="module" src="../js/firebase-config.js"></script>
    <script type="module" src="../js/saas-engine.js"></script>
    <script type="module" src="js/admin.js"></script>
</body>
</html>